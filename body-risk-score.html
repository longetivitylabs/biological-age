<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Body Risk Score Booking</title>
  <!-- Favicon -->
  <link rel="icon" href="img/Favicon__2_-removebg-preview.ico" type="image/x-icon">
  <link rel="shortcut icon" href="img/Favicon__2_-removebg-preview.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Tailwind CSS CDN -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

  <style>
    @font-face {
      font-family: 'Archia-Bold';
      src: url(Archia_Font/Archia-Bold.otf);
    }
    @font-face {
      font-family: 'Archia-Medium';
      src: url(Archia_Font/Archia-Medium.otf);
    }
    :root {
      --primary-color: #0E406B;
      --secondary-color: #193d3d;
      --accent-color: #4CAF50;
      --feature-color-1: #e8f5e9;
      --feature-color-2: #e3f2fd;
      --feature-color-3: #fce4ec;
      --feature-color-4: #fff8e1;
      --bg-gradient: linear-gradient(135deg, #f1f5f9, #e2e8f0);
      --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      --hover-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
      --button-gradient: linear-gradient(135deg, #0E406B, #1e5799);
      --button-hover-gradient: linear-gradient(135deg, #092d4f, #16345c);
      --checkbox-color: #0E406B;
    }


    .preloaderBg {
      position: fixed;
      z-index: 9999;
      top: 0;
      left: 0;
      background: #d9f0ff;
      width: 100%;
      height: 100%;
      text-align: center;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }

    .preloader {
      background: url(https://cdn.shopify.com/s/files/1/0591/2389/2291/files/favicon__3_-removebg-preview_863b420e-87da-4ff2-a1f0-7b0a2793b76a.png?v=1733122225) no-repeat center;
      background-size: 150px;
      width: 300px;
      height: 300px;
    }

    .preloader2 {
      border: 5px solid #f3f3f3;
      border-top: 5px solid #0E406B;
      border-radius: 50%;
      width: 250px;
      height: 250px;
      animation: spin 1s ease-in-out infinite;
      margin-top: -280px; /* overlap effect as before */
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }



    
    body {
      background: var(--bg-gradient);
      padding: 40px 20px;
      display: flex;
      justify-content: center;
      font-family: 'Archia-Medium';
      align-items: center;
      min-height: 100vh;
      margin: 0;
      transition: background 0.5s ease;
    }
    
    .package-box {
      background: white;
      padding: 40px;
      max-width: 900px;
      width: 100%;
      border-radius: 24px;
      box-shadow: var(--card-shadow);
      animation: fadeIn 1s ease-in-out;
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
    }
    
    .package-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: var(--button-gradient);
    }
    
    .package-box:hover {
      box-shadow: var(--hover-shadow);
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .package-box h2 {
      margin-top: 0;
      color: var(--primary-color);
      font-size: 28px;
      margin-bottom: 30px;
      text-align: center;
      position: relative;
      padding-bottom: 12px;
    }
    
    .package-box h2::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 3px;
      background: var(--button-gradient);
      border-radius: 2px;
    }
    
    .layout-container {
      display: flex;
      flex-direction: row;
      gap: 40px;
    }
    
    .left-column {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .right-column {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      padding-top: 10px;
      border-left: 1px solid #eaeaea;
      padding-left: 40px;
    }
    
    .feature-section {
      margin-bottom: 25px;
    }
    
    .feature-section h3 {
      color: var(--primary-color);
      margin-bottom: 20px;
      font-size: 20px;
      position: relative;
      display: inline-block;
    }
    
    .feature-section h3::after {
      content: '✨';
      position: absolute;
      right: -25px;
      animation: sparkle 2s infinite;
    }
    
    @keyframes sparkle {
      0% { opacity: 0; transform: scale(0.8) rotate(0deg); }
      50% { opacity: 1; transform: scale(1.1) rotate(10deg); }
      100% { opacity: 0; transform: scale(0.8) rotate(0deg); }
    }
    
    .feature-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }
    
    .feature-item {
      padding: 16px;
      border-radius: 12px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      box-shadow: 0 3px 10px rgba(0,0,0,0.05);
      display: flex;
      flex-direction: row;
      align-items: center;
      text-align: left;
      animation: featureFadeIn 0.8s forwards;
      opacity: 0;
      cursor: pointer;
    }
    
    .feature-item:nth-child(1) {
      background: var(--feature-color-1);
      animation-delay: 0.2s;
    }
    
    .feature-item:nth-child(2) {
      background: var(--feature-color-2);
      animation-delay: 0.4s;
    }
    
    .feature-item:nth-child(3) {
      background: var(--feature-color-3);
      animation-delay: 0.6s;
    }
    
    .feature-item:nth-child(4) {
      background: var(--feature-color-4);
      animation-delay: 0.8s;
    }
    
    @keyframes featureFadeIn {
      from { 
        opacity: 0; 
        transform: translateX(-15px); 
      }
      to { 
        opacity: 1; 
        transform: translateX(0); 
      }
    }
    
    .feature-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
    }
    
    .feature-icon {
      font-size: 24px;
      margin-right: 15px;
      display: inline-block;
      background: rgba(255, 255, 255, 0.5);
      width: 45px;
      height: 45px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    
    .feature-item:hover .feature-icon {
      animation: bounce 0.5s;
    }
    
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    .feature-text {
      flex: 1;
    }
    
    .feature-item h4 {
      margin: 0 0 5px 0;
      color: var(--primary-color);
      font-size: 16px;
      font-weight: 600;
    }
    
    .feature-item p {
      margin: 0;
      font-family: 'Archia-Medium';
      font-size: 14px;
      color: #000;
    }
    
    .feature-price {
      font-weight: bold;
      color: var(--primary-color);
      font-size: 16px;
      margin-left: 10px;
    }
    
    /* Custom checkbox styling */
    .checkbox-container {
      display: flex;
      align-items: center;
      margin-left: auto;
      flex-shrink: 0;
    }
    
    .custom-checkbox {
      position: relative;
      display: inline-block;
      width: 20px;
      height: 20px;
      background-color: #fff;
      border: 2px solid #ddd;
      border-radius: 25%;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    input[type="checkbox"] {
      position: absolute;
      opacity: 0;
      cursor: pointer;
      height: 0;
      width: 0;
    }
    
    input[type="checkbox"]:checked ~ .custom-checkbox {
      background-color: var(--checkbox-color);
      border-color: var(--checkbox-color);
    }
    
    .custom-checkbox:after {
      content: "";
      position: absolute;
      display: none;
      left: 6px;
      top: 1px;
      width: 6px;
      height: 12px;
      border: solid white;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }
    
    input[type="checkbox"]:checked ~ .custom-checkbox:after {
      display: block;
    }
    
    .pincode-section {
      margin-bottom: 25px;
      background: #f8fafc;
      border-radius: 12px;
      padding: 20px;
    }
    
    .pincode-section h3 {
      color: var(--primary-color);
      margin-top: 0;
      margin-bottom: 15px;
      font-size: 18px;
    }
    
    .pincode-checker {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    input[type="text"] {
      padding: 15px;
      font-size: 16px;
      width: 100%;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      transition: all 0.3s ease;
      box-sizing: border-box;
    }
    
    input[type="text"]:focus {
      border-color: var(--primary-color);
      outline: none;
      box-shadow: 0 0 0 3px rgba(14, 64, 107, 0.1);
    }
    
    .check-btn {
      background-color: #0E406B;
      color: white;
      padding: 12px 20px;
      font-size: 16px;
      font-family: 'Archia-Medium';
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }
    
    .check-btn:hover {
      filter: brightness(1.1);
      transform: translateY(-2px);
    }
    
    .result {
      font-size: 16px;
      margin-top: 12px;
      text-align: center;
      min-height: 24px;
      transition: all 0.3s ease;
    }
    
    .available {
      color: green;
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.7; }
      100% { opacity: 1; }
    }
    
    .unavailable {
      color: #d32f2f;
    }
    
    .tick {
      color: green;
      margin-right: 5px;
    }
    
    .cta-btn {
      background: var(--button-gradient);
      color: white;
      padding: 18px;
      border: none;
      font-size: 18px;
      font-family: 'Archia-Medium';
      width: 100%;
      border-radius: 12px;
      margin-top: 24px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(14, 64, 107, 0.3);
    }
    
    .cta-btn:hover {
      background: var(--button-hover-gradient);
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(14, 64, 107, 0.4);
    }
    
    .cta-btn:active {
      transform: translateY(0);
    }
    
    .cta-btn::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 5px;
      height: 5px;
      background: rgba(255, 255, 255, 0.5);
      opacity: 0;
      border-radius: 100%;
      transform: scale(1, 1) translate(-50%);
      transform-origin: 50% 50%;
    }
    
    .cta-btn:focus:not(:active)::after {
      animation: ripple 1s ease-out;
    }
    
    @keyframes ripple {
      0% {
        transform: scale(0, 0);
        opacity: 0.5;
      }
      20% {
        transform: scale(25, 25);
        opacity: 0.3;
      }
      100% {
        opacity: 0;
        transform: scale(40, 40);
      }
    }
    
    /* Floating animation for CTA button */
    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-6px); }
      100% { transform: translateY(0px); }
    }
    
    .float-animation {
      animation: float 3s ease-in-out infinite;
    }
    
    /* Billing Summary Section */
    .total-price-section {
      background: #f0f7ff;
      border-radius: 12px;
      padding: 16px 20px;
      margin-bottom: 20px;
      border: 2px solid #c9e0ff;
      transition: all 0.3s ease;
      text-align: center;
    }
    
    .total-price-section h3 {
      color: var(--primary-color);
      margin-top: 0;
      margin-bottom: 10px;
      font-size: 18px;
    }
    
    .total-price {
      font-size: 24px;
      font-weight: 700;
      color: #0E406B;
      margin: 0;
      transition: all 0.3s ease;
    }
    
    .price-updated {
      animation: highlight 1s ease;
    }
    
    
    @keyframes highlight {
      0% { background-color: #ffeb3b; }
      100% { background-color: #f0f7ff; }
    }
    
    .selected-feature {
      border: 2px solid var(--primary-color);
    }
    
    /* Added style for pre-selected item */
    .pre-selected {
      border: 2px solid var(--primary-color);
      background-color: var(--feature-color-1);
      position: relative;
    }
    
    .pre-selected:after {
      content: "Included";
      position: absolute;
      top: 1px;
      right: 1px;
      background: var(--primary-color);
      color: white;
      font-size:8px;
      padding: 3px 8px;
      border-radius: 10px;
    }
    
    /* Improved Responsive design */
    @media (max-width: 768px) {
      body {
        padding: 20px 10px;
      }
      
      .package-box {
        padding: 25px 15px;
        border-radius: 16px;
      }
      
      .package-box h2 {
        font-size: 22px;
        margin-bottom: 20px;
      }
      
      .layout-container {
        flex-direction: column;
        gap: 25px;
      }
      
      .right-column {
        border-left: none;
        border-top: 1px solid #eaeaea;
        padding-left: 0;
        padding-top: 25px;
      }
      
      .feature-item {
        padding: 12px;
        flex-direction: column;
        text-align: center;
        align-items: center;
      }
      
      .feature-icon {
        margin-right: 0;
        margin-bottom: 10px;
        width: 40px;
        height: 40px;
      }
      
      .feature-text {
        width: 100%;
        text-align: center;
        margin-bottom: 10px;
      }
      
      .feature-item h4 {
        font-size: 15px;
      }
      
      .feature-item p {
        font-size: 13px;
      }
      
      .checkbox-container {
        margin-left: 0;
        margin-top: 5px;
        justify-content: center;
      }
      
      .feature-price {
        margin-left: 5px;
      }
      
      .pre-selected:after {
        top: 5px;
        right: 5px;
        font-size: 10px;
      }
      
      .cta-btn {
        padding: 15px;
        font-size: 16px;
      }
      
      .total-price {
        font-size: 22px;
      }
      
      .pincode-section,
      .total-price-section {
        padding: 15px;
      }
      
      .pincode-section h3,
      .total-price-section h3,
      .feature-section h3 {
        font-size: 16px;
      }
      
      input[type="text"] {
        padding: 12px;
        font-size: 14px;
      }
      
      .check-btn {
        padding: 10px 15px;
        font-size: 14px;
      }
      
      .result {
        font-size: 14px;
      }
    }
    
    /* Additional media query for extremely small screens */
    @media (max-width: 360px) {
      .package-box {
        padding: 15px 12px;
      }
      
      .feature-item {
        padding: 10px 8px;
      }
      
      .feature-icon {
        width: 35px;
        height: 35px;
      }
      
      .feature-item h4 {
        font-size: 14px;
      }
      
      .feature-item p {
        font-size: 12px;
      }
    }
    
  </style>
</head>
<body>
  <div class="preloaderBg" id="preloader">
    <div class="preloader"></div>
    <div class="preloader2"></div>
  </div>

  <div class="package-box">
    <h2>Get Your Body Risk Score</h2>
    
    <div class="layout-container">
      <!-- Left column with merged feature grid (includes checkboxes) -->
      <div class="left-column">
        <div class="feature-section">
          <h3>Choose Your Tests</h3>
          
          <div class="feature-grid">
            <div class="feature-item pre-selected" id="bioAgeFeature">
              <span class="feature-icon">🧬</span>
              <div class="feature-text">
                <h4>Biological Age & Rate of Ageing</h4>
                <p>Know your true body age and how fast you're aging</p>
              </div>
            </div>
            
            <label class="feature-item" id="diabetesHeartFeature" for="addDiabetesHeart">
              <span class="feature-icon">❤️</span>
              <div class="feature-text">
                <h4>Diabetes & Heart Risk Score</h4>
                <p>Detailed health profile for cardiac, blood sugar, and lipid risk + 75 other tests </p>
              </div>
              <div class="checkbox-container">
                <input type="checkbox" id="addDiabetesHeart" onchange="updateTotalPrice(); toggleFeatureSelection(this, 'diabetesHeartFeature')">
                <span class="custom-checkbox"></span>
                <span class="feature-price">₹2000</span>
              </div>
            </label>
            
            <label class="feature-item" id="thyroidFeature" for="addThyroid">
              <span class="feature-icon">⚡</span>
              <div class="feature-text">
                <h4>Thyroid Risk Score</h4>
                <p>⁠Complete thyroid function analysis and autoimmune indicators </p>
              </div>
              <div class="checkbox-container">
                <input type="checkbox" id="addThyroid" onchange="updateTotalPrice(); toggleFeatureSelection(this, 'thyroidFeature')">
                <span class="custom-checkbox"></span>
                <span class="feature-price">₹2000</span>
              </div>
            </label>
          </div>
        </div>
      </div>
      
      <!-- Right column with pincode checker and CTA -->
      <div class="right-column">
        <div class="pincode-section">
          <h3>Check Availability</h3>
          <div class="pincode-checker">
            <input type="text" id="pincodeInput" placeholder="Enter Pincode">
            <button class="check-btn" onclick="checkPincode()">Check Availability</button>
          </div>
          
          <div id="result" class="result"></div>
        </div>
        
        <!-- Total Price Display -->
        <div class="total-price-section" id="totalPriceSection">
          <h3>Billing Summary</h3>
          <p class="total-price" id="totalPrice">₹2000</p>
        </div>

        <div class="bg-yellow-100 border border-yellow-300 text-yellow-800 p-4 rounded-lg mt-5 text-xs sm:text-sm font-normal text-center">
          <ul class="list-disc pl-5 space-y-1">
            <b>Booking for more than one person?</b>
            <p>Place separate orders—each person gets their own guided journey.</p>
          </ul>
        </div>
        
        <button id="bookTestBtn" class="cta-btn float-animation">Book Your Test Now</button>
      </div>
    </div>
  </div>

  
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <!-- Cashfree SDK -->
  <script src="https://sdk.cashfree.com/js/ui/2.0.0/cashfree.prod.js"></script>

  <script>
    const bioAgeingPrice = 2000;
    const diabetesHeartPrice = 2000;
    const thyroidPrice = 2000;

    let availablePincodes = [];

  // Load and transform pincodes from JSON
  fetch('pincodes.json')
  .then(response => response.json())
  .then(data => {
    availablePincodes = data.map(entry => String(entry.Pincode));
  })
  .catch(error => {
    console.error("Error loading pincodes:", error);
  });

  function checkPincode() {
    const input = document.getElementById("pincodeInput").value.trim();
    const resultDiv = document.getElementById("result");

    resultDiv.style.opacity = 0;

    setTimeout(() => {
      if (availablePincodes.includes(input)) {
        resultDiv.innerHTML = `<span class="tick">✔</span><span class="available">Available in your area!</span>`;
      } else {
        resultDiv.innerHTML = `<span class="unavailable">Sorry, our services are currently unavailable at your pincode.</span>`;
      }

      resultDiv.style.opacity = 1;
    }, 300);
  }

  function updateTotalPrice() {
    const isDHR = document.getElementById("addDiabetesHeart").checked;
    const isThyroid = document.getElementById("addThyroid").checked;
    const totalEl = document.getElementById("totalPrice");
    const section = document.getElementById("totalPriceSection");

    let total = bioAgeingPrice;
    if (isDHR) total += diabetesHeartPrice;
    if (isThyroid) total += thyroidPrice;

    totalEl.textContent = `₹${total}`;
    section.classList.remove("price-updated");
    void section.offsetWidth;
    section.classList.add("price-updated");

    const btn = document.getElementById("bookTestBtn");
    btn.disabled = false;
    btn.style.opacity = "1";
    btn.style.cursor = "pointer";
  }

  function toggleFeatureSelection(checkbox, featureId) {
    const feature = document.getElementById(featureId);
    if (checkbox.checked) {
      feature.classList.add('selected-feature');
    } else {
      feature.classList.remove('selected-feature');
    }
  }

  // Handle Booking Button
  document.getElementById("bookTestBtn").addEventListener("click", () => {
    const pincode = document.getElementById("pincodeInput").value.trim();
    const isDHR = document.getElementById("addDiabetesHeart").checked;
    const isThyroid = document.getElementById("addThyroid").checked;
    const btn = document.getElementById("bookTestBtn");

    let total = bioAgeingPrice;
    if (isDHR) total += diabetesHeartPrice;
    if (isThyroid) total += thyroidPrice;

    if (!pincode) {
      alert("Please enter your pincode.");
      return;
    }

    if (!availablePincodes.includes(pincode)) {
      alert("Sorry, we don't serve your location.");
      return;
    }

    btn.textContent = "Processing...";
    btn.disabled = true;
    btn.classList.remove("float-animation");

    setTimeout(() => {
      btn.textContent = "Book Your Test Now";
      btn.disabled = false;
      btn.classList.add("float-animation");

      let description = "Body Risk Score:";
      const selections = ["Biological Age/Ageing Rate"];
      if (isDHR) selections.push("Diabetes/Heart Risk");
      if (isThyroid) selections.push("Thyroid Risk");
      description += " " + selections.join(" + ");

      // Start Cashfree Payment Flow
      const paymentData = {
        order_amount: 2000,
        description: "BioAge + Diabetes Risk Test",
        customer_details: {
          customer_id: "44334433",
          customer_name: "Test User",
          customer_email: "test@example.com",
          customer_phone: "9123456780"
        }
      };
      var paymentSessionID = "";
// Make POST request to backend API
fetch("/create/cashfree/order", {
  method: "POST",
  headers: {
    "Content-Type": "application/json"
  },
  body: JSON.stringify(paymentData)
})

.then(response => {
  if (!response.ok) throw new Error("Network response was not ok");
  return response.json();
  console.log(response);
})
.then(data => {
  if (!data.payment_session_id) {
    throw new Error("Session ID missing");
  }
  console.log(data);
  paymentSessionID = data.payment_session_id;
});
var cashfree = Cashfree({
  mode: "production"
});

let checkoutOptions = {
  paymentSessionId: paymentSessionID,
  redirectTarget: "_modal",
};


cashfree.checkout(checkoutOptions).then((result) => {
  if (result.error) {
        // This will be true whenever user clicks on close icon inside the modal or any error happens during the payment
        console.log("User has closed the popup or there is some payment error, Check for Payment Status");
        console.log(result.error);
      }
      if (result.redirect) {
        // This will be true when the payment redirection page couldnt be opened in the same window
        // This is an exceptional case only when the page is opened inside an inAppBrowser
        // In this case the customer will be redirected to return url once payment is completed
        console.log("Payment will be redirected");
      }
      if (result.paymentDetails) {
        // This will be called whenever the payment is completed irrespective of transaction status
        console.log("Payment has been completed, Check for Payment Status");
        console.log(result.paymentDetails.paymentMessage);
      }
    });
}, 700);
  });

  // Preloader and Initialization
  window.onload = function () {
    preloadTime = setTimeout(function () {
      document.getElementById("preloader").style.display = "none";
      document.querySelector(".package-box").style.display = "block";
      updateTotalPrice();
    }, 1000);
  };
</script>

<script src="clean-urls.js"></script>

</body>
</html>